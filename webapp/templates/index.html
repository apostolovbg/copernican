<!doctype html>
<html>
<head>
    <title>Copernican Suite</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
    function openTab(evt, name) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName('tabcontent');
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = 'none';
        }
        tablinks = document.getElementsByClassName('tablinks');
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(' active', '');
        }
        document.getElementById(name).style.display = 'block';
        evt.currentTarget.className += ' active';
    }
    </script>
</head>
<body>
    <h1>Copernican Suite {{ version }}</h1>
    {% with msgs = get_flashed_messages() %}
      {% if msgs %}
        <ul class="flashes">
        {% for m in msgs %}<li>{{ m }}</li>{% endfor %}
        </ul>
      {% endif %}
    {% endwith %}
    <form method="post" action="{{ url_for('toggle_run') }}">
        {% if run_active %}
        <button type="submit" name="action" value="abort" class="abort">Abort run</button>
        {% else %}
        <button type="submit" name="action" value="start">Run analysis</button>
        {% endif %}
    </form>
    <button onclick="alert('Model compiler coming soon!')">Compile model</button>
    <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'Model')">Alternative model</button>
        <button class="tablinks" onclick="openTab(event, 'Engine')">Computational engine</button>
        <button class="tablinks" onclick="openTab(event, 'Datasets')">Datasets</button>
        <button class="tablinks" onclick="openTab(event, 'Run')">Run</button>
        <button class="tablinks" onclick="openTab(event, 'Hubble')">Hubble diagram</button>
        <button class="tablinks" onclick="openTab(event, 'BAO')">BAO</button>
        <button class="tablinks" onclick="openTab(event, 'Export')">Export results</button>
    </div>
    <div id="Model" class="tabcontent">
        <form method="post" action="{{ url_for('upload_model') }}" enctype="multipart/form-data">
            <input type="file" name="model_json" accept=".json" required>
            <button type="submit">Upload</button>
        </form>
        {% if model %}<p>Current model: {{ model }}</p>{% endif %}
    </div>
    <div id="Engine" class="tabcontent">
        <form method="post" action="{{ url_for('select_engine') }}">
            {% for eng in engines %}
            <label><input type="radio" name="engine" value="{{ eng }}" {% if engine==eng %}checked{% endif %}> {{ eng }}</label><br>
            {% endfor %}
            <button type="submit">Employ selected engine</button>
        </form>
    </div>
    <div id="Datasets" class="tabcontent">
        <form method="post" action="{{ url_for('select_datasets') }}">
            <p>SNe dataset:</p>
            <label><input type="radio" name="sne_source" value="unistra" {% if sne=='unistra' %}checked{% endif %}> University of Strasbourg</label><br>
            <p>BAO dataset:</p>
            <label><input type="radio" name="bao_source" value="basic" {% if bao=='basic' %}checked{% endif %}> Basic set</label><br>
            <button type="submit">Confirm</button>
        </form>
    </div>
    <div id="Run" class="tabcontent">
        <pre>{{ log_text }}</pre>
    </div>
    <div id="Hubble" class="tabcontent">
        {% if hubble_plot %}<img src="{{ url_for('session_file', filename=hubble_plot) }}" alt="Hubble plot">{% else %}<p>No plot available.</p>{% endif %}
    </div>
    <div id="BAO" class="tabcontent">
        {% if bao_plot %}<img src="{{ url_for('session_file', filename=bao_plot) }}" alt="BAO plot">{% else %}<p>No plot available.</p>{% endif %}
    </div>
    <div id="Export" class="tabcontent">
        <a href="{{ url_for('download') }}">Download results</a>
    </div>
</body>
</html>

